clear; cls; clf;

% =====================================================
% 1) Construct X[k]
% =====================================================
f1 = 0. ; f2 = 0. ; f3 = f1 + f2;
f4 = 0. ; f5 = 0. ; f6 = f4 + f5;

a1 = 2*pi*rand(); a2 = 2*pi*rand(); a3 = a1 + a2;
a4 = 2*pi*rand(); a5 = 2*pi*rand(); a6 = a4 + a5;

N = 8192;
k = 0:1:(N-1);

x1 = cos(2*pi*f1*k+a1); x2 = cos(2*pi*f2*k+a2);
x3 = cos(2*pi*f3*k+a3); x4 = cos(2*pi*f4*k+a4);
x5 = cos(2*pi*f5*k+a5); x6 = cos(2*pi*f6*k+a6);

X = x1+x2+x3+x4+x5+x6;

% =====================================================
% 2) Estimate the power-spectrum
% =====================================================
r = autocorr(X,128);
C = abs(fft(r));
f = frequency axis

% ===================================================== 
% 3) Estimate the bispectrum:
% i)   direct method K=32, M=256, J=0
% ii)  indirect method K=32, M=256, L=64 parzen window
% iii) indirect method K=32, M=256, L=64 rectangular window
% =====================================================
[B1,f1] = bispecd(X,256,0,256,0.0);
[B2,f2] = bispeci(X,64,256,0.0,'biased',256,0);
[B3,f3] = bispeci(X,64,256,0.0,'biased',256,1);

% =====================================================
% 4) Plot the results
% =====================================================

% =====================================================
% 5) Repeat everything with different parameters
% i)  K=16, M=512, L=64
% ii) K=64, M=128, L=64
% =====================================================
[B4,f4] = bispecd(X,512,0,512,0.0); 
[B5,f5] = bispeci(X,64,512,0.0,'biased',512,0); 
[B6,f6] = bispeci(X,64,512,0.0,'biased',512,1);

[B7,f7] = bispecd(X,128,0,128,0.0); 
[B8,f8] = bispeci(X,64,128,0.0,'biased',128,0); 
[B9,f9] = bispeci(X,64,128,0.0,'biased',128,0);

% =====================================================
% 6) Plot the new results
% =====================================================
